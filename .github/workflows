name: Push Docker Image to ECR
on:
push:
branches: main
5
jobs

build:
runs-on: ubuntu- latest
steps :
- name: Configure AWS Credentials
uses: aws-actions/configure-aws-credentials@v1

with:
aws-access-key-id: ${{ secrets. AWS_ACCESS_KEY_ID }}
aws-secret-access-key: ${{ secrets. AWS_SECRET_ACCESS_KEY }}
aws -region: us-east -1

name: Log in to Amazon ECR
id: login-ecr
uses: aws-actions/amazon-ecr- login@v1
- name: Build, tag, and push image to Amazon ECR

env :
ECR_REGISTRY: ${{ steps. login-ecr . outputs. registry }}
ECR_REPOSITORY: ${{ secrets. ECR_REPOSITORY }}
IMAGE_TAG: ${{ github. sha }}
run: I
docker build -t SECR_REGISTRY/SECR_REPOSITORY : $IMAGE_TAG .
docker push SECR_REGISTRY/$ECR_REPOSITORY : $IMAGE_TAG

- name: Log out of Amazon ECR
if: always( )
run: docker logout ${{ steps. login-ecr . outputs . registry }}
